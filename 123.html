library(caret); library(kernlab); library(lattice); library(ggplot2)
library(e1071); library(Hmisc); library(gridExtra); library(RANN)
library(rpart); library(rattle); library(rpart.plot); library(purrr)
library(tidyr); library(magrittr); library(dplyr)

# Load the training dataset
download.file(url = "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv", 
              destfile = "./pml-training.csv", method = "curl")


data_training <- read.csv("./pml-training.csv", na.strings=c("NA","#DIV/0!",""))


## Data partitioning
inTrain <- createDataPartition(y=data_training$classe, 
                               p=0.75, list=FALSE)


training <- data_training[inTrain, ]
testing <- data_training[-inTrain, ]
dim(training); dim(testing)


summary(data_training$classe)

##To check variables with missing values
apply(data_training,2,function(x) sum(is.na(x)))

### There are unnecessary variables in dataset
training_final <- training[, -c(1:7)]
testing_final <- testing[, -c(1:7)]

#Remove those columns with missing values (except classe column)

training_final_clean  <- training_final[ ,!names(training_final) %in% names(training_final)[apply(training_final, 2, anyNA)]]
testing_final_clean <- testing_final[ , !names(testing_final) %in% names(testing_final)[apply(testing_final, 2, anyNA)]]


names(training_final_clean)
